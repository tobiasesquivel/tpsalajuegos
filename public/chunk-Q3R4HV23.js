import{a as j,b as p,c as M,d as P,h as k,i as V,j as w,k as A,l as q,m as T,n as G,o as D,p as R,q as z,r as U,t as $}from"./chunk-C3KL25CK.js";import{a as N}from"./chunk-L5GLGSRE.js";import{d as O}from"./chunk-GLJWXLRS.js";import"./chunk-QTCHNE4Q.js";import{a as I}from"./chunk-HXP6K52P.js";import{k as E,l as y,p as F}from"./chunk-HW2YZ5O7.js";import{Ea as C,Ja as d,Ra as l,Ua as a,Va as t,W as h,Wa as f,X as _,Za as S,ab as v,bb as b,fb as s,gb as m,hb as g,ua as o,za as u}from"./chunk-AOP3JIL5.js";import"./chunk-X5YLR3NI.js";import{i as x}from"./chunk-ODN5LVDJ.js";function Q(i,r){if(i&1&&(a(0,"label"),f(1,"input",16),s(2),t()),i&2){let e=r.$implicit;o(),l("value",e),o(),g(" ",e," ")}}function H(i,r){if(i&1){let e=S();a(0,"label")(1,"input",17),v("change",function(c){h(e);let L=b();return _(L.onCheckboxChange(c))}),t(),s(2),t()}if(i&2){let e=r.$implicit;o(),l("value",e),o(),g(" ",e," ")}}function J(i,r){if(i&1&&(a(0,"option",18),s(1),t()),i&2){let e=r.$implicit;l("value",e),o(),m(e)}}function K(i,r){if(i&1&&(a(0,"div",19),s(1),t()),i&2){let e=b();o(),m(e.mensaje)}}var B=class i{constructor(r,e,n,c){this.fb=r;this.usuarioService=e;this.supabaseService=n;this.router=c;this.encuestaForm=this.fb.group({nombre_apellido:["",p.required],edad:["",[p.required,p.min(18),p.max(99)]],telefono:["",[p.required,p.pattern("^[0-9]{1,10}$")]],preguntas:this.fb.group({preguntas:["",p.required],plataformas:this.fb.array([]),horas:["",p.required]})})}encuestaForm;mensaje="";cargando=!1;preguntasOpciones=[{label:"\xBFTe gustan los juegos de preguntas?",value:"preguntas",type:"radio",opciones:["S\xED","No"]},{label:"\xBFQu\xE9 plataformas usas para jugar?",value:"plataformas",type:"checkbox",opciones:["PC","Consola","M\xF3vil"]},{label:"\xBFCu\xE1ntas horas juegas por semana?",value:"horas",type:"select",opciones:["<5","5-10","10-20","20+"]}];ngOnInit(){}onCheckboxChange(r){let e=this.encuestaForm.get("preguntas.plataformas");if(r.target.checked)e.push(this.fb.control(r.target.value));else{let n=e.controls.findIndex(c=>c.value===r.target.value);n!==-1&&e.removeAt(n)}}onSubmit(){return x(this,null,function*(){if(this.encuestaForm.invalid){this.mensaje="Por favor, completa todos los campos correctamente.";return}this.cargando=!0,this.mensaje="";let r=this.usuarioService.obtenerUsuarioActual();if(!r){this.mensaje="Debes estar logueado para enviar la encuesta.",this.cargando=!1;return}let e=this.encuestaForm.value,n={preguntas:e.preguntas.preguntas,plataformas:e.preguntas.plataformas,horas:e.preguntas.horas},{error:c}=yield this.supabaseService.getCliente().from("encuestas").insert([{usuario_id:r.id,nombre_apellido:e.nombre_apellido,edad:e.edad,telefono:e.telefono,respuestas:n,fecha:new Date().toISOString()}]);this.cargando=!1,c?this.mensaje="Error al guardar la encuesta.":(this.mensaje="\xA1Encuesta enviada correctamente!",this.encuestaForm.reset())})}static \u0275fac=function(e){return new(e||i)(u(U),u(N),u(I),u(O))};static \u0275cmp=C({type:i,selectors:[["app-encuesta"]],decls:38,vars:10,consts:[[1,"encuesta-panel","card"],[1,"card-header"],[1,"titulo-juego"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"dato-usuario"],["formControlName","nombre_apellido","type","text","required","",1,"form-control"],["formControlName","edad","type","number","required","",1,"form-control"],["formControlName","telefono","type","text","required","",1,"form-control"],["formGroupName","preguntas",1,"dato-usuario"],[4,"ngFor","ngForOf"],["formControlName","horas",1,"form-control"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-success",3,"disabled"],["class","resultado","style","margin-top:12px;",4,"ngIf"],["type","radio","formControlName","preguntas",3,"value"],["type","checkbox",3,"change","value"],[3,"value"],[1,"resultado",2,"margin-top","12px"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),s(3,"Encuesta"),t()(),a(4,"div",3)(5,"form",4),v("ngSubmit",function(){return n.onSubmit()}),a(6,"div",5)(7,"label"),s(8,"Nombre y Apellido:"),t(),f(9,"input",6),t(),a(10,"div",5)(11,"label"),s(12,"Edad:"),t(),f(13,"input",7),t(),a(14,"div",5)(15,"label"),s(16,"Tel\xE9fono:"),t(),f(17,"input",8),t(),a(18,"div",9)(19,"label"),s(20),t(),a(21,"div"),d(22,Q,3,2,"label",10),t()(),a(23,"div",9)(24,"label"),s(25),t(),a(26,"div"),d(27,H,3,2,"label",10),t()(),a(28,"div",9)(29,"label"),s(30),t(),a(31,"select",11)(32,"option",12),s(33,"Selecciona una opci\xF3n"),t(),d(34,J,2,2,"option",13),t()(),a(35,"button",14),s(36),t(),d(37,K,2,1,"div",15),t()()()),e&2&&(o(5),l("formGroup",n.encuestaForm),o(15),m(n.preguntasOpciones[0].label),o(2),l("ngForOf",n.preguntasOpciones[0].opciones),o(3),m(n.preguntasOpciones[1].label),o(2),l("ngForOf",n.preguntasOpciones[1].opciones),o(3),m(n.preguntasOpciones[2].label),o(4),l("ngForOf",n.preguntasOpciones[2].opciones),o(),l("disabled",n.cargando),o(),g(" ",n.cargando?"Enviando...":"Enviar"," "),o(),l("ngIf",n.mensaje))},dependencies:[$,k,D,R,j,V,G,w,M,P,z,A,T,q,F,E,y],styles:[".encuesta-panel[_ngcontent-%COMP%]{max-width:500px;margin:32px auto}.card[_ngcontent-%COMP%]{background:var(--paneles);box-shadow:0 4px 20px var(--sombra-sutil);border-radius:12px;padding:24px;border:none}.card-header[_ngcontent-%COMP%]{background:var(--color-primario);color:#fff;border-radius:12px 12px 0 0;padding:16px 0;text-align:center}.titulo-juego[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:600}.dato-usuario[_ngcontent-%COMP%]{margin-bottom:18px;font-size:1.1rem;display:flex;flex-direction:column;gap:4px}.form-control[_ngcontent-%COMP%]{padding:6px 10px;border-radius:6px;border:1px solid #ccc;font-size:1rem}.btn-success[_ngcontent-%COMP%]{background:var(--color-primario);color:#fff;border:none;border-radius:6px;padding:8px 18px;font-size:1rem;margin-top:8px;cursor:pointer;transition:background .2s}.btn-success[_ngcontent-%COMP%]:disabled{background:#ccc;color:#888;cursor:not-allowed}.resultado[_ngcontent-%COMP%]{font-size:1rem;color:var(--color-secundario)}"]})};export{B as EncuestaComponent};
